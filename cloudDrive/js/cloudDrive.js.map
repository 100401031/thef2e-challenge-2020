{"version":3,"sources":["cloudDrive/js/cloudDrive.js"],"names":["vm","Vue","el","data","sidebarDropdownVisible","fileNavDropdownVisible","storage_size","storage_usage","searchInput","searchResult","dataStorage","rootFolder","id","name","editable","modifiedTime","size","ownerId","fileType","fileList","isStar","childrenFolder","path","trash","star","starFileId","lastSection","currentSection","currentFolder","preFolderNav","folderNav","preventRecord","dragoverItem","rightClickItem","isDraggingItem","newFolderName","fileDropdownVisible","computed","displayfolderNav","length","newArray","slice","newDisplayfolderNav","concat","splice","storeUsagePercentage","displayFileList","searchFilter","result","searchFile","watch","handler","newVal","oldVal","push","editableFolder","$nextTick","$","removeClass","addClass","methods","folder","filter","item","toLowerCase","includes","forEach","filterStarFile","handleClickOutside","e","elName","getAttribute","handleListItemDblClick","isInTrash","handleNavToFolder","target","targetIndex","findIndex","createFolder","newFolder","_creatUuid","Date","getTime","saveToLocalStorage","dragStart","dragEnd","dragOver","targetElem","dragLeave","drop","srcItem","targetItem","moveDriveFile","handleUploadFile","dataTransfer","files","uploadByInput","file","targetFolder","i","receiveFile","type","alert","convertFile","then","fileId","fileName","newFile","lastModified","checkFileType","saveToLocal","JSON","stringify","localStorage","catch","err","console","log","indexOfItem","indexOf","indexInList","Promise","resolve","reject","reader","FileReader","onload","onerror","error","readAsDataURL","stringData","setItem","download","decodeData","parse","getItem","a","document","createElement","href","setAttribute","click","activeUploadInput","$refs","fileInput","moveToTrash","delFile","find","delFileIndex","saveToLocalTrash","deleteFile","removeItem","recycleItem","pathArray","split","current","childFolder","indexOfDelItem","d","now","performance","replace","c","r","Math","random","floor","toString","fileContextMenu","addStar","findObj","obj","index","starPage","starFile","storeData","trashData","filters","timeFormat","timestamp","date","year","getFullYear","month","getMonth","day","getDate","hours","getHours","minutes","getMinutes","seconds","getSeconds","substr","sizeFormat","bytes","decimals","isNaN","k","dm","sizes","parseFloat","pow","toFixed","created","getStoreData","getTrashData","mounted","directives","bind","binding","vnode","clickOutsideEvent","event","contains","context","expression","body","addEventListener","unbind","removeEventListener","contextMenu","selector","items","upload","callback","createNewFolder","modal","recycle","delete"],"mappings":"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","sourcesContent":["var vm;\nvm = new Vue({\n  el: '#app',\n  data: {\n    sidebarDropdownVisible: false,\n    fileNavDropdownVisible: false,\n    storage_size: 5000000,\n    storage_usage: 0,\n    searchInput: '',\n    searchResult: [],\n    dataStorage: {\n      rootFolder: {\n        id: 'root',\n        name: '我的雲端硬碟',\n        editable: true,\n        modifiedTime: '',\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        fileList: [\n          {\n            id: '#1-f',\n            name: 'Hello World!',\n            editable: true,\n            isStar: false,\n            modifiedTime: 1598047432044,\n            size: '',\n            ownerId: 'me',\n            fileType: 'folder',\n            childrenFolder: [],\n            fileList: [],\n            path: '/root'\n          }\n        ],\n        path: ''\n      },\n      trash: {\n        id: 'trash',\n        name: '垃圾桶',\n        editable: false,\n        modifiedTime: '',\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        fileList: []\n      },\n      star: {\n        id: 'star',\n        name: '已加星號',\n        editable: false,\n        modifiedTime: '',\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        fileList: []\n      }\n    },\n    starFileId: [],\n    lastSection: null,\n    currentSection: null,\n    currentFolder: null,\n    preFolderNav: [],\n    folderNav: [],\n    preventRecord: false,\n    dragoverItem: null,\n    rightClickItem: null,\n    isDraggingItem: null,\n    newFolderName: '新文件夾',\n    fileDropdownVisible: false\n  },\n  computed: {\n    displayfolderNav() {\n      if (this.folderNav.length > 3) {\n        const newArray = this.folderNav.slice(1, -1);\n        const newDisplayfolderNav = [].concat(this.folderNav);\n        newDisplayfolderNav.splice(1, this.folderNav.length - 2, newArray);\n        return newDisplayfolderNav;\n      } else {\n        return this.folderNav;\n      }\n    },\n    storeUsagePercentage() {\n      return (this.storage_usage / this.storage_size) * 100;\n    },\n    displayFileList() {\n      return this.currentFolder.fileList;\n    },\n    searchFilter() {\n      if (this.searchInput != '') {\n        const result = this.searchFile(this.dataStorage.rootFolder, this.searchInput);\n        return result;\n      } else return [];\n    }\n  },\n  watch: {\n    currentFolder: {\n      handler(newVal, oldVal) {\n        if (oldVal && !this.preventRecord) {\n          if (\n            newVal.id == 'root' ||\n            newVal.id == 'trash' ||\n            newVal.id == 'search' ||\n            newVal.id == 'star'\n          ) {\n            this.folderNav = [];\n            this.folderNav.push(newVal);\n          } else {\n            //將資料夾路徑紀錄至folderNav\n            this.folderNav.push(newVal);\n          }\n          if (newVal.editable) {\n            this.editableFolder = true;\n          } else {\n            this.editableFolder = false;\n          }\n        }\n        if (\n          newVal.id == 'root' ||\n          newVal.id == 'trash' ||\n          newVal.id == 'search' ||\n          newVal.id == 'star'\n        ) {\n          if (oldVal) {\n            this.lastSection = this.currentSection;\n          }\n          this.currentSection = newVal.id;\n        }\n        this.$nextTick(() => {\n          if (this.lastSection) {\n            $('.table_wrapper').removeClass(this.lastSection);\n          }\n          $('.table_wrapper').addClass(this.currentSection);\n        });\n      }\n    },\n    dragoverItem() {\n      //TODO: 目前class被改動就會影響到contextmenu的判斷，應將contextmenu改為vue內data驅動\n      this.$nextTick(() => {\n        if (this.lastSection) {\n          $('.table_wrapper').removeClass(this.lastSection);\n        }\n        $('.table_wrapper').addClass(this.currentSection);\n      });\n    },\n    searchFilter(newVal) {\n      const result = {\n        id: 'search',\n        name: '搜尋結果',\n        editable: false,\n        modifiedTime: '',\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        fileList: newVal,\n        path: ''\n      };\n      this.currentFolder = result;\n      if (this.searchInput == '') {\n        this.currentFolder = this.dataStorage.rootFolder;\n      }\n    }\n  },\n  methods: {\n    searchFile(folder, searchInput) {\n      const filter = folder.fileList.filter(item =>\n        item.name.toLowerCase().includes(searchInput.toLowerCase())\n      );\n      const result = [...filter];\n      const childrenFolder = folder.fileList.filter(item => item.fileType == 'folder');\n      //是否有下一層\n      if (childrenFolder.length > 0) {\n        childrenFolder.forEach(item => {\n          //回傳結果再push進result\n          this.searchFile(item, searchInput).forEach(item => {\n            result.push(item);\n          });\n        });\n      }\n      return result;\n    },\n    filterStarFile(folder) {\n      const filter = folder.fileList.filter(item => item.isStar === true);\n      const result = [...filter];\n      const childrenFolder = folder.fileList.filter(item => item.fileType == 'folder');\n      //是否有下一層\n      if (childrenFolder.length > 0) {\n        childrenFolder.forEach(item => {\n          //回傳結果再push進result\n          this.filterStarFile(item).forEach(item => {\n            result.push(item);\n          });\n        });\n      }\n      return result;\n    },\n    handleClickOutside(e, el) {\n      const elName = el.getAttribute('el-name');\n      this[`${elName}Visible`] = false;\n    },\n    handleListItemDblClick(item) {\n      if (item.isInTrash) return;\n      if (item.fileType === 'folder') {\n        this.currentFolder = item;\n      } else {\n        //TODO 待新增檔案預覽功能\n      }\n    },\n    handleNavToFolder(target) {\n      if (target === this.currentFolder) return;\n      //找到物件nav index 刪除它後面紀錄\n      const targetIndex = this.folderNav.findIndex(item => item.id == target.id);\n      this.folderNav.splice(targetIndex);\n      //防止watch時把此動作記錄下來\n      this.preventRecord = true;\n      this.currentFolder = target;\n      this.preventRecord = false;\n    },\n    createFolder(name = '新文件夾') {\n      this.sidebarDropdownVisible = false;\n      const newFolder = {\n        id: this._creatUuid(),\n        name,\n        editable: true,\n        isStar: false,\n        modifiedTime: new Date().getTime(),\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        fileList: [],\n        path: this.currentFolder.path + '/' + this.currentFolder.id\n      };\n      this.currentFolder.fileList.push(newFolder);\n      //save to local\n      this.saveToLocalStorage();\n      this.newFolderName = '新文件夾';\n    },\n    //拖曳開始，設定目前拖曳中元素\n    dragStart(e, item) {\n      if (!this.currentFolder.editable) return;\n      this.isDraggingItem = item;\n      $('.table_wrapper').addClass('draggedTable');\n    },\n\n    //拖曳結束，清除拖曳及目標元素\n    dragEnd(e, item) {\n      this.isDraggingItem = null;\n      this.dragoverItem = null;\n      $('.table_wrapper').removeClass('draggedTable');\n    },\n    //設定目前拖曳目標\n    dragOver(targetElem) {\n      if (!this.currentFolder.editable) return;\n      if (\n        !this.dragoverItem &&\n        !targetElem.fileList.includes(this.isDraggingItem) &&\n        targetElem != this.isDraggingItem\n      ) {\n        this.dragoverItem = targetElem;\n      }\n    },\n    //若拖曳離開目前目標元素，則將目標元素設定為null\n    dragLeave() {\n      if (!this.currentFolder.editable) return;\n      this.dragoverItem = null;\n    },\n    //拖曳檔案被移動至目標元素中\n    drop(e, targetElem) {\n      if (!this.currentFolder.editable) return;\n      let srcItem = this.isDraggingItem;\n      let targetItem = this.dragoverItem;\n      //判斷是否為Drive上既有檔案，若true則進行搬移\n      if (srcItem) {\n        //若拖曳檔案與目標檔案相同則return\n        if (srcItem == targetItem || !targetItem) return;\n        else this.moveDriveFile(srcItem, targetItem);\n        targetItem = null;\n        return;\n      }\n      //判斷是否為Drive上既有檔案，若false則將檔案存至local並將檔案資訊加入隸屬檔案夾物件\n      this.handleUploadFile(e.dataTransfer.files, targetElem);\n      this.dragoverItem = null;\n    },\n    uploadByInput(e) {\n      if (!this.currentFolder.editable) return;\n      this.handleUploadFile(e.target.files, this.currentFolder);\n      this.sidebarDropdownVisible = false;\n    },\n    //處理上傳檔案\n    handleUploadFile(file, targetFolder) {\n      for (let i = 0; i < file.length; i++) {\n        const receiveFile = file[i];\n        if (receiveFile.type == '') {\n          alert(`「${receiveFile.name}」格式錯誤，目前暫不支援上傳此種格式。`);\n          return;\n        }\n        if (receiveFile.size > 3890704) {\n          alert(\n            `「${receiveFile.name}」檔案太大囉，由於是存入localStorage，建議測試檔案小於3.8MB。`\n          );\n          return;\n        }\n        this.convertFile(receiveFile)\n          .then(data => {\n            const fileId = this._creatUuid();\n            const fileName = receiveFile.name;\n            const newFile = {\n              id: fileId,\n              name: fileName,\n              isStar: false,\n              modifiedTime: receiveFile.lastModified,\n              size: receiveFile.size,\n              ownerId: 'me',\n              fileType: this.checkFileType(receiveFile.type),\n              path: this.currentFolder.path + '/' + this.currentFolder.id\n            };\n            targetFolder.fileList.push(newFile);\n            this.saveToLocal(data, fileId, fileName);\n            this.storage_usage = JSON.stringify(localStorage).length * 0.77;\n            //save to local\n            this.saveToLocalStorage();\n          })\n          .catch(err => {\n            console.log('err', err);\n          });\n      }\n    },\n    //Drive檔案搬移\n    moveDriveFile(srcItem, targetItem) {\n      if (srcItem.fileType != 'folder' && targetItem.fileType == 'folder') {\n        const indexOfItem = this.currentFolder.fileList.indexOf(srcItem);\n        targetItem.fileList.push(srcItem);\n        this.currentFolder.fileList.splice(indexOfItem, 1);\n        //save to local\n        this.saveToLocalStorage();\n      } else if (srcItem.fileType == 'folder' && targetItem.fileType == 'folder') {\n        const indexInList = this.currentFolder.fileList.indexOf(srcItem);\n        //加入\n        targetItem.fileList.push(srcItem);\n        //移出\n        this.currentFolder.fileList.splice(indexInList, 1);\n        //save to local\n        this.saveToLocalStorage();\n      }\n    },\n    checkFileType(fileType) {\n      console.log(fileType);\n      if (fileType.includes('mp4')) return 'mp4';\n      if (fileType.includes('image')) return 'image';\n      if (\n        fileType.includes('msword') ||\n        fileType.includes('application/vnd.openxmlformats-officedocument.wordprocessingml.document')\n      )\n        return 'msword';\n      if (fileType.includes('pdf')) return 'pdf';\n      else return 'default';\n    },\n    convertFile(file) {\n      return new Promise((resolve, reject) => {\n        let reader = new FileReader();\n        reader.onload = () => {\n          resolve(reader.result);\n        };\n        reader.onerror = () => {\n          reject(reader.error);\n        };\n        reader.readAsDataURL(file);\n      });\n    },\n    saveToLocal(data, fileId, fileName) {\n      const newFile = { data, fileId, fileName };\n      const stringData = JSON.stringify(newFile);\n      localStorage.setItem(fileId, stringData);\n    },\n    download(item = this.rightClickItem) {\n      if (this.currentSection == 'trash') return;\n      if (item.fileType == 'folder') return;\n      const decodeData = JSON.parse(localStorage.getItem(item.id));\n      var a = document.createElement('a');\n      a.href = decodeData.data;\n      a.setAttribute('download', item.name);\n      a.click();\n    },\n    activeUploadInput() {\n      if (this.currentSection != 'root') {\n        this.currentFolder = this.dataStorage.rootFolder;\n      }\n      this.$refs.fileInput.click();\n    },\n    moveToTrash(file = this.rightClickItem) {\n      if (this.currentSection == 'trash') return;\n      file.isInTrash = true;\n      this.dataStorage.trash.fileList.push(file);\n      const delFile = this.currentFolder.fileList.find(item => item.id == file.id);\n      const delFileIndex = this.currentFolder.fileList.indexOf(delFile);\n      this.currentFolder.fileList.splice(delFileIndex, 1);\n      //save to local\n      this.saveToLocalStorage();\n      this.saveToLocalTrash();\n    },\n    deleteFile(file = this.rightClickItem) {\n      const delFileIndex = this.dataStorage.trash.fileList.indexOf(file);\n      this.dataStorage.trash.fileList.splice(delFileIndex, 1);\n      localStorage.removeItem(file.id);\n      this.storage_usage = JSON.stringify(localStorage).length * 0.77;\n      //save to local\n      this.saveToLocalTrash();\n    },\n    recycleItem(item = this.rightClickItem) {\n      if (this.currentSection != 'trash') return;\n      ///讀取path\n      const pathArray = item.path.split('/');\n      //刪除根目錄及前方空白\n      pathArray.splice(0, 2);\n      var targetFolder;\n      if (pathArray.length == 0) {\n        //檔案於根目錄\n        targetFolder = this.dataStorage.rootFolder;\n      } else {\n        //檔案於子目錄\n        var current = this.dataStorage.rootFolder;\n        for (let i = 0; i < pathArray.length; i++) {\n          const childFolder = current.fileList.find(item => item.id == pathArray[i]);\n          current = childFolder;\n        }\n        targetFolder = current;\n      }\n      item.isInTrash = false;\n      targetFolder.fileList.push(item);\n      const indexOfDelItem = this.dataStorage.trash.fileList.indexOf(item);\n      this.dataStorage.trash.fileList.splice(indexOfDelItem, 1);\n      //save to local\n      this.saveToLocalStorage();\n      this.saveToLocalTrash();\n    },\n    _creatUuid() {\n      var d = Date.now();\n      if (typeof performance !== 'undefined' && typeof performance.now === 'function') {\n        d += performance.now(); //use high-precision timer if available\n      }\n      return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\n        var r = (d + Math.random() * 16) % 16 | 0;\n        d = Math.floor(d / 16);\n        return (c === 'x' ? r : (r & 0x3) | 0x8).toString(16);\n      });\n    },\n    fileContextMenu(item) {\n      this.rightClickItem = item;\n    },\n    addStar(item = this.rightClickItem) {\n      item.isStar = !item.isStar;\n      this.saveToLocalStorage();\n      this.saveToLocalTrash();\n      if (item.isStar) {\n        this.dataStorage.star.fileList.push(item);\n      } else {\n        const target = this.dataStorage.star.fileList;\n        const findObj = target.find(obj => obj.id == item.id);\n        const index = target.indexOf(findObj);\n        target.splice(index, 1);\n      }\n    },\n    starPage() {\n      const starFile = this.filterStarFile(this.dataStorage.rootFolder);\n      this.dataStorage.star.fileList = starFile;\n      this.currentFolder = this.dataStorage.star;\n    },\n    saveToLocalStorage() {\n      //save to LocalStorage\n      const storeData = JSON.stringify(this.dataStorage.rootFolder.fileList);\n      localStorage.setItem('myStorage', storeData);\n    },\n    saveToLocalTrash() {\n      //save to Local Trash\n      const trashData = JSON.stringify(this.dataStorage.trash.fileList);\n      localStorage.setItem('myTrash', trashData);\n    }\n  },\n  filters: {\n    timeFormat(timestamp) {\n      let date = new Date(timestamp);\n      let year = date.getFullYear();\n      let month = date.getMonth() + 1;\n      let day = date.getDate();\n      let hours = '0' + date.getHours();\n      let minutes = '0' + date.getMinutes();\n      let seconds = '0' + date.getSeconds();\n      return `${year}-${month}-${day} ${hours.substr(-2)}:${minutes.substr(-2)}:${seconds.substr(\n        -2\n      )}`;\n    },\n    sizeFormat(bytes, decimals = 1) {\n      if (isNaN(bytes) || !bytes) return '';\n      if (bytes === 0) return '0 Bytes';\n      const k = 1024;\n      const dm = decimals < 0 ? 0 : decimals;\n      const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB', 'PB', 'EB', 'ZB', 'YB'];\n      const i = Math.floor(Math.log(bytes) / Math.log(k));\n      return parseFloat((bytes / Math.pow(k, i)).toFixed(dm)) + ' ' + sizes[i];\n    }\n  },\n  created() {\n    this.currentFolder = this.dataStorage.rootFolder;\n    this.folderNav.push(this.dataStorage.rootFolder);\n    this.storage_usage = JSON.stringify(localStorage).length * 0.77;\n    const starFile = this.filterStarFile(this.dataStorage.rootFolder);\n    this.dataStorage.star.fileList = starFile;\n    const getStoreData = JSON.parse(localStorage.getItem('myStorage')) || [\n      {\n        id: '#1-f',\n        name: 'Hello World!',\n        editable: true,\n        isStar: false,\n        modifiedTime: 1598047432044,\n        size: '',\n        ownerId: 'me',\n        fileType: 'folder',\n        childrenFolder: [],\n        fileList: [],\n        path: '/root'\n      }\n    ];\n    const getTrashData = JSON.parse(localStorage.getItem('myTrash')) || [];\n    this.dataStorage.rootFolder.fileList = getStoreData;\n    this.dataStorage.trash.fileList = getTrashData;\n  },\n  mounted() {},\n  directives: {\n    'click-outside': {\n      bind: function (el, binding, vnode) {\n        el.clickOutsideEvent = function (event) {\n          const elName = el.getAttribute('el-name');\n          if (\n            !(el == event.target || el.contains(event.target)) &&\n            elName != event.target.getAttribute('bind-el')\n          ) {\n            vnode.context[binding.expression](event, el);\n          }\n        };\n        document.body.addEventListener('click', el.clickOutsideEvent);\n        document.body.addEventListener('contextmenu', el.clickOutsideEvent);\n      },\n      unbind: function (el) {\n        document.body.removeEventListener('click', el.clickOutsideEvent);\n        document.body.removeEventListener('contextmenu', el.clickOutsideEvent);\n      }\n    }\n  }\n});\n\n//雲端硬碟 右鍵選單\n$(function () {\n  $.contextMenu({\n    selector: '.table_contextmenu.root',\n    items: {\n      upload: {\n        name: '上傳檔案',\n        callback() {\n          vm.activeUploadInput();\n        }\n      },\n      createNewFolder: {\n        name: '新增資料夾',\n        callback() {\n          $('#newFolderModal').modal('show');\n        }\n      }\n    }\n  });\n});\n\n//檔案夾右鍵選單\n$(function () {\n  $.contextMenu({\n    selector: '.table_contextmenu.root .folder_type',\n    items: {\n      // share: { name: '共享' },\n      // download: {\n      //   name: '下載',\n      //   callback() {\n      //     vm.download();\n      //   }\n      // },\n      star: {\n        name: '標示星號',\n        callback() {\n          vm.addStar();\n        }\n      },\n      moveToTrash: {\n        name: '移至垃圾桶',\n        callback() {\n          vm.moveToTrash();\n        }\n      }\n    }\n  });\n});\n//檔案右鍵選單\n$(function () {\n  $.contextMenu({\n    selector: '.table_contextmenu.root .doc_type',\n    items: {\n      download: {\n        name: '下載',\n        callback() {\n          vm.download();\n        }\n      },\n      star: {\n        name: '標示星號',\n        callback() {\n          vm.addStar();\n        }\n      },\n      moveToTrash: {\n        name: '移至垃圾桶',\n        callback() {\n          vm.moveToTrash();\n        }\n      }\n    }\n  });\n});\n\n//垃圾桶檔案及檔案夾右鍵選單\n$(function () {\n  $.contextMenu({\n    selector: '.table_contextmenu.trash .doc_type , .table_contextmenu.trash .folder_type',\n    items: {\n      recycle: {\n        name: '還原',\n        callback() {\n          vm.recycleItem();\n        }\n      },\n      delete: {\n        name: '永久刪除',\n        callback() {\n          $('#deleteModal').modal('show');\n        }\n      }\n    }\n  });\n});\n"],"file":"cloudDrive.js"}