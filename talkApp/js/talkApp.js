"use strict";var vm=new Vue({el:"#app",data:{currentGroup:{},msgRecognizing:!1,msgRecording:!1,autoSend:!1,tempMsg:{text:null,audioBlob:null,audioUrl:null,audioDuration:null},groups:[{id:"#1",title:"101 Airborne Division",messages:[]},{id:"#2",title:"Easy Company",messages:[]}]},computed:{messages:function(){return this.currentGroup.messages.reverse()}},methods:{recordFn:function(){return{mediaRecorder:null,start:function(){var t=this;vm.msgRecording=!0,navigator.mediaDevices.getUserMedia({audio:!0}).then(function(e){t.mediaRecorder=new MediaRecorder(e),t.mediaRecorder.start();var i=Date.now(),r=[];t.mediaRecorder.addEventListener("dataavailable",function(e){r.push(e.data)}),t.mediaRecorder.addEventListener("stop",function(){var e=Date.now();vm.tempMsg.audioDuration=e-i;var t=new Blob(r),n=URL.createObjectURL(t);vm.tempMsg.audioBlob=t,vm.tempMsg.audioUrl=n,vm.autoSend&&vm.sendMsg()})})},end:function(){this.mediaRecorder.stop(),vm.msgRecording=!1}}},inputRecognition:function(){var r=this,e=e||webkitSpeechRecognition,o=(webkitSpeechGrammarList,webkitSpeechRecognitionEvent,new e);o.continuous=!0,o.interimResults=!0,o.lang="en-US";var t=this.recordFn();o.start(),o.onstart=function(){t.start(),r.msgRecognizing=!0},o.onend=function(){t.end(),r.commandRecognition(),r.msgRecognizing=!1},o.onresult=function(e){for(var t="",n="",i=e.resultIndex;i<e.results.length;++i)e.results[i].isFinal?(n+=e.results[i][0].transcript,r.tempMsg.text=n,o.stop()):(t+=e.results[i][0].transcript,r.tempMsg.text=t)}},commandRecognition:function(){var o=this,e=e||webkitSpeechRecognition,t=t||webkitSpeechGrammarList,n=(webkitSpeechRecognitionEvent,"#JSGF V1.0; grammar commands; public <commands> = "+["switch to"].join(" | ")+" ;"),i=new e,r=new t;r.addFromString(n,1),i.grammars=r,i.lang="en-US",i.continuous=!0,i.interimResults=!1,i.maxAlternatives=1,i.start(),i.onend=function(){setTimeout(function(){o.msgRecording||o.commandRecognition()},50)},i.onresult=function(e){var t,n;o.msgRecognizing||(t=e.results.length-1,(n=e.results[t][0].transcript).toLowerCase().includes("switch to")&&function(e){var t;if(e.includes("channel")){var n=e.replace("switch to channel","").trim(),i=parseInt(n,10)-1;t=o.groups[i]}else{var r=e.replace("switch to","").trim();if(r==o.currentGroup.title)return;t=o.groups.find(function(e){return e.title.toLowerCase()==r})}t&&o.currentGroup!==t&&(o.currentGroup=t)}(n.toLowerCase()))}},sendMsg:function(e,t){var n=1<arguments.length&&void 0!==t?t:this.tempMsg;n.sentTime=Date.now(),this.currentGroup.messages.push(n),this.tempMsg={text:null,audioBlob:null,audioUrl:null,audioDuration:null}}},created:function(){this.commandRecognition(),this.currentGroup=this.groups[0]}});
//# sourceMappingURL=talkApp.js.map
